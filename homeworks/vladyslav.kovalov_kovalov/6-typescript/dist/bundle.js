/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/

class Game {
    constructor(currentKeyElement, totalScoreElement, roundScoreElement, balloonElement, progressElement, recordsTemplate, recordsList) {
        this.currentKeyElement = currentKeyElement;
        this.totalScoreElement = totalScoreElement;
        this.roundScoreElement = roundScoreElement;
        this.balloonElement = balloonElement;
        this.progressElement = progressElement;
        this.recordsTemplate = recordsTemplate;
        this.recordsList = recordsList;
        this.paused = true;
        this.LETTERS = "abcdefghijklmnopqrstuvwxyz";
        this.INTERVAL = 2000;
        this.FINAL_SCORE = 200;
        this.currentKey = '';
        this.score = 100;
        this.timer = 0;
        this.sessionScores = [];
    }
    getBestGameScores() {
        const sorted = this.sessionScores.sort((x, y) => y - x);
        const bestTenGames = sorted.slice(0, 10);
        return bestTenGames;
    }
    addListElement(element, container) {
        container.append(element);
    }
    generateListElement(scoreValue) {
        const content = this.recordsTemplate.content.cloneNode(true);
        const listElement = content.querySelector('[data-template-records-item]');
        listElement.textContent = scoreValue;
        return listElement;
    }
    renderScores() {
        const scores = this.getBestGameScores();
        scores.forEach(score => {
            const listElement = this.generateListElement(score);
            this.addListElement(listElement, this.recordsList);
        });
    }
    getRandomLetterPosition(letterString) {
        return Math.floor(Math.random() * letterString.length);
    }
    getRandomLetter(letterString) {
        return letterString[this.getRandomLetterPosition(letterString)];
    }
    getRandomScore(min, max) {
        return Math.floor(Math.random() * (max - min) + min);
    }
    setRandomKey() {
        const randomLetter = this.getRandomLetter(this.LETTERS);
        this.currentKey = randomLetter.toUpperCase();
        this.currentKeyElement.textContent = this.currentKey;
    }
    setRoundScore(score, action) {
        this.roundScoreElement.textContent = `${action}${score}`;
    }
    updateTotalScore() {
        this.totalScoreElement.textContent = `${this.score.toString()}`;
    }
    increaseBalloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height + 5}px`;
        this.balloonElement.style.width = `${width + 5}px`;
    }
    decreaseBaloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height - 5}px`;
        this.balloonElement.style.width = `${width - 5}px`;
    }
    reset() {
        clearInterval(this.timer);
        this.timer = 0;
        this.progressElement.style.width = '100%';
    }
    renderEndGame(message) {
        clearInterval(this.timer);
        this.reset();
        this.totalScoreElement.textContent = message;
        this.roundScoreElement.innerHTML = '0';
        this.paused = true;
    }
    checkScore() {
        if (this.score <= 0) {
            this.renderEndGame('You lose!');
        }
        if (this.score >= 200) {
            this.renderEndGame('You won!');
            this.sessionScores.push(this.score);
        }
    }
    addScore() {
        const min = 5;
        const max = 10;
        const currentScore = this.getRandomScore(min, max);
        this.score += currentScore;
        this.setRoundScore(currentScore, '+');
        this.updateTotalScore();
        this.increaseBalloon();
    }
    removeScore() {
        const min = 20;
        const max = 25;
        const currentScore = this.getRandomScore(min, max);
        this.score -= currentScore;
        this.setRoundScore(currentScore, '-');
        this.updateTotalScore();
        this.decreaseBaloon();
    }
    checkPressedKey(key) {
        if (key === this.currentKey) {
            clearInterval(this.timer);
            return this.addScore();
        }
        ;
        if (key !== this.currentKey) {
            clearInterval(this.timer);
            return this.removeScore();
        }
        ;
    }
    start() {
        this.setRandomKey();
    }
    setTimer() {
        let step = 10;
        let counter = 100;
        this.timer = window.setInterval(() => {
            if (counter >= 0) {
                this.progressElement.style.width = counter + '%';
                counter -= step;
                return;
            }
            clearInterval(this.timer);
            const min = 10;
            const max = 15;
            const currentScore = this.getRandomScore(min, max);
            this.score -= currentScore;
            this.setRoundScore(currentScore, '-');
            this.updateTotalScore();
            this.decreaseBaloon();
            if (this.score > 0) {
                game.setRandomKey();
                this.setTimer();
            }
            game.checkScore();
        }, this.INTERVAL / 10);
    }
    buttonStart() {
        this.paused = false;
        this.reset();
        this.roundScoreElement.innerHTML = '0';
        this.currentKey = '';
        this.score = 100;
        this.totalScoreElement.textContent = `${this.score}`;
        this.start();
        this.setTimer();
        this.setRandomKey();
        this.renderScores();
    }
    buttonEnd() {
        this.paused = true;
        this.reset();
        this.currentKey = '';
        this.totalScoreElement.textContent = 'You lose!';
        this.roundScoreElement.innerHTML = '0';
    }
    buttonRestart() {
        this.reset();
        this.roundScoreElement.innerHTML = '0';
        this.currentKey = '';
        this.score = 100;
        this.totalScoreElement.textContent = `${this.score}`;
    }
}
const currentKeyElement = document.querySelector('[data-current-key]');
const totalScoreElement = document.querySelector('[data-total-score]');
const roundScoreElement = document.querySelector('[data-round-score]');
const balloonElement = document.querySelector('[data-balloon-item]');
const progressElement = document.querySelector('[data-progress]');
const buttonsContainerElement = document.querySelector('[data-buttons-container]');
const recordsTemplate = document.querySelector('[data-templace-records]');
const recordsList = document.querySelector('[data-records-list]');
const game = new Game(currentKeyElement, totalScoreElement, roundScoreElement, balloonElement, progressElement, recordsTemplate, recordsList);
game.start();
document.addEventListener('keydown', e => {
    game.checkScore();
    const pressedKey = e.key.toUpperCase();
    if (!game.paused) {
        game.checkPressedKey(pressedKey);
        game.setRandomKey();
        game.setTimer();
    }
});
buttonsContainerElement.addEventListener('click', event => {
    if (event.target instanceof HTMLElement && event.target.dataset.action !== '') {
        if (event.target.dataset.action === 'start')
            game.buttonStart();
        if (event.target.dataset.action === 'end')
            game.buttonEnd();
        if (event.target.dataset.action === 'restart')
            game.buttonRestart();
    }
});

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxDQUFDLGFBQWEsRUFBRSxDQUFDO0tBQ3RFO0FBQ0wsQ0FBQyxDQUFFLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly82LXR5cGVzY3JpcHQvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgR2FtZSB7XG4gICAgcHVibGljIHBhdXNlZDogYm9vbGVhbiA9IHRydWU7XG4gICAgcHJpdmF0ZSBMRVRURVJTOiBzdHJpbmcgPSBcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XCI7XG4gICAgcHJpdmF0ZSBJTlRFUlZBTDogbnVtYmVyID0gMjAwMDtcbiAgICBwcml2YXRlIEZJTkFMX1NDT1JFOiBudW1iZXIgPSAyMDA7XG4gICAgcHJpdmF0ZSBjdXJyZW50S2V5OiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAxMDA7XG4gICAgcHJpdmF0ZSB0aW1lcjogbnVtYmVyID0gMDtcbiAgICBwdWJsaWMgc2Vzc2lvblNjb3JlczogbnVtYmVyW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGN1cnJlbnRLZXlFbGVtZW50OiBIVE1MU3BhbkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgdG90YWxTY29yZUVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHJvdW5kU2NvcmVFbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBiYWxsb29uRWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcHJvZ3Jlc3NFbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSByZWNvcmRzVGVtcGxhdGU6IEhUTUxUZW1wbGF0ZUVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcmVjb3Jkc0xpc3Q6IEhUTUxETGlzdEVsZW1lbnQsXG4gICAgKSB7IH1cblxuICAgIHByaXZhdGUgZ2V0QmVzdEdhbWVTY29yZXMoKTogbnVtYmVyW10ge1xuICAgICAgICBjb25zdCBzb3J0ZWQ6IG51bWJlcltdID0gdGhpcy5zZXNzaW9uU2NvcmVzLnNvcnQoKHgsIHkpID0+IHkgLSB4KTtcbiAgICAgICAgY29uc3QgYmVzdFRlbkdhbWVzOiBudW1iZXJbXSA9IHNvcnRlZC5zbGljZSgwLCAxMCk7XG4gICAgICAgIHJldHVybiBiZXN0VGVuR2FtZXM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRMaXN0RWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCwgY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2VuZXJhdGVMaXN0RWxlbWVudChzY29yZVZhbHVlOiBudW1iZXIpOiBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLnJlY29yZHNUZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgY29uc3QgbGlzdEVsZW1lbnQ6IGFueSA9ICg8SFRNTEVsZW1lbnQ+Y29udGVudCkucXVlcnlTZWxlY3RvcignW2RhdGEtdGVtcGxhdGUtcmVjb3Jkcy1pdGVtXScpO1xuICAgICAgICBsaXN0RWxlbWVudC50ZXh0Q29udGVudCA9IHNjb3JlVmFsdWU7XG4gICAgICAgIHJldHVybiBsaXN0RWxlbWVudDtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyU2NvcmVzKCkge1xuICAgICAgICBjb25zdCBzY29yZXMgPSB0aGlzLmdldEJlc3RHYW1lU2NvcmVzKCk7XG4gICAgICAgIHNjb3Jlcy5mb3JFYWNoKHNjb3JlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbGVtZW50ID0gdGhpcy5nZW5lcmF0ZUxpc3RFbGVtZW50KHNjb3JlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkTGlzdEVsZW1lbnQobGlzdEVsZW1lbnQsIHRoaXMucmVjb3Jkc0xpc3QpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFJhbmRvbUxldHRlclBvc2l0aW9uKGxldHRlclN0cmluZzogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGxldHRlclN0cmluZy5sZW5ndGgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UmFuZG9tTGV0dGVyKGxldHRlclN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGxldHRlclN0cmluZ1t0aGlzLmdldFJhbmRvbUxldHRlclBvc2l0aW9uKGxldHRlclN0cmluZyldO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UmFuZG9tU2NvcmUobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluKTtcbiAgICB9XG5cbiAgICBzZXRSYW5kb21LZXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmRvbUxldHRlcjogc3RyaW5nID0gdGhpcy5nZXRSYW5kb21MZXR0ZXIodGhpcy5MRVRURVJTKTtcbiAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0gcmFuZG9tTGV0dGVyLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIHRoaXMuY3VycmVudEtleUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLmN1cnJlbnRLZXk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRSb3VuZFNjb3JlKHNjb3JlOiBudW1iZXIsIGFjdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHthY3Rpb259JHtzY29yZX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlVG90YWxTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuc2NvcmUudG9TdHJpbmcoKX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5jcmVhc2VCYWxsb29uKCk6IHZvaWQge1xuICAgICAgICBsZXQgd2lkdGg6IG51bWJlciA9IHRoaXMuYmFsbG9vbkVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGxldCBoZWlnaHQ6IG51bWJlciA9IHRoaXMuYmFsbG9vbkVsZW1lbnQub2Zmc2V0V2lkdGg7XG5cbiAgICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHQgKyA1fXB4YDtcbiAgICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3dpZHRoICsgNX1weGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkZWNyZWFzZUJhbG9vbigpOiB2b2lkIHtcbiAgICAgICAgbGV0IHdpZHRoOiBudW1iZXIgPSB0aGlzLmJhbGxvb25FbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSB0aGlzLmJhbGxvb25FbGVtZW50Lm9mZnNldFdpZHRoO1xuXG4gICAgICAgIHRoaXMuYmFsbG9vbkVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0IC0gNX1weGA7XG4gICAgICAgIHRoaXMuYmFsbG9vbkVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHt3aWR0aCAtIDV9cHhgO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzZXQoKTogdm9pZCB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgIHRoaXMudGltZXIgPSAwO1xuICAgICAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckVuZEdhbWUobWVzc2FnZTogc3RyaW5nKTogdm9pZHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5yb3VuZFNjb3JlRWxlbWVudC5pbm5lckhUTUwgPSAnMCc7XG4gICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2hlY2tTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgaWYodGhpcy5zY29yZSA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckVuZEdhbWUoJ1lvdSBsb3NlIScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5zY29yZSA+PSAyMDApIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRW5kR2FtZSgnWW91IHdvbiEnKTtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvblNjb3Jlcy5wdXNoKHRoaXMuc2NvcmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgICAgIGNvbnN0IG1pbjogbnVtYmVyID0gNTtcbiAgICAgICAgICAgIGNvbnN0IG1heDogbnVtYmVyID0gMTA7XG5cbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTY29yZTogbnVtYmVyID0gdGhpcy5nZXRSYW5kb21TY29yZShtaW4sIG1heCk7XG4gICAgICAgICAgICB0aGlzLnNjb3JlICs9IGN1cnJlbnRTY29yZTtcbiAgICAgICAgICAgIHRoaXMuc2V0Um91bmRTY29yZShjdXJyZW50U2NvcmUsICcrJyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRvdGFsU2NvcmUoKTtcbiAgICAgICAgICAgIHRoaXMuaW5jcmVhc2VCYWxsb29uKClcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbW92ZVNjb3JlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDIwO1xuICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDI1O1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTY29yZTogbnVtYmVyID0gdGhpcy5nZXRSYW5kb21TY29yZShtaW4sIG1heCk7XG4gICAgICAgIHRoaXMuc2NvcmUgLT0gY3VycmVudFNjb3JlO1xuICAgICAgICB0aGlzLnNldFJvdW5kU2NvcmUoY3VycmVudFNjb3JlLCAnLScpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRvdGFsU2NvcmUoKTtcbiAgICAgICAgdGhpcy5kZWNyZWFzZUJhbG9vbigpXG4gICAgfVxuXG4gICAgY2hlY2tQcmVzc2VkS2V5KGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGlmIChrZXkgPT09IHRoaXMuY3VycmVudEtleSkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZFNjb3JlKClcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGtleSAhPT0gdGhpcy5jdXJyZW50S2V5KSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlU2NvcmUoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXJ0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNldFJhbmRvbUtleSgpO1xuICAgIH1cblxuICAgIHNldFRpbWVyKCk6IHZvaWQge1xuICAgICAgICBsZXQgc3RlcCA9IDEwO1xuICAgICAgICBsZXQgY291bnRlciA9IDEwMDtcbiAgICAgICAgdGhpcy50aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoY291bnRlciA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9ncmVzc0VsZW1lbnQuc3R5bGUud2lkdGggPSBjb3VudGVyICsgJyUnO1xuICAgICAgICAgICAgICAgIGNvdW50ZXIgLT0gc3RlcDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG5cbiAgICAgICAgICAgIGNvbnN0IG1pbjogbnVtYmVyID0gMTA7XG4gICAgICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDE1O1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNjb3JlOiBudW1iZXIgPSB0aGlzLmdldFJhbmRvbVNjb3JlKG1pbiwgbWF4KTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmUgLT0gY3VycmVudFNjb3JlO1xuICAgICAgICAgICAgdGhpcy5zZXRSb3VuZFNjb3JlKGN1cnJlbnRTY29yZSwgJy0nKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVG90YWxTY29yZSgpO1xuICAgICAgICAgICAgdGhpcy5kZWNyZWFzZUJhbG9vbigpXG5cbiAgICAgICAgaWYodGhpcy5zY29yZSA+IDApIHtcbiAgICAgICAgICAgIGdhbWUuc2V0UmFuZG9tS2V5KCk7XG4gICAgICAgICAgICB0aGlzLnNldFRpbWVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBnYW1lLmNoZWNrU2NvcmUoKTtcbiAgICAgICAgfSwgdGhpcy5JTlRFUlZBTCAvIDEwKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYnV0dG9uU3RhcnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgdGhpcy5yb3VuZFNjb3JlRWxlbWVudC5pbm5lckhUTUwgPSAnMCc7XG4gICAgICAgIHRoaXMuY3VycmVudEtleSA9ICcnO1xuICAgICAgICB0aGlzLnNjb3JlID0gMTAwO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gYCR7dGhpcy5zY29yZX1gO1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMuc2V0VGltZXIoKTtcbiAgICAgICAgdGhpcy5zZXRSYW5kb21LZXkoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJTY29yZXMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYnV0dG9uRW5kKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBhdXNlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0gJyc7XG4gICAgICAgIHRoaXMudG90YWxTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSAnWW91IGxvc2UhJztcbiAgICAgICAgdGhpcy5yb3VuZFNjb3JlRWxlbWVudC5pbm5lckhUTUwgPSAnMCc7XG4gICAgfVxuXG4gICAgcHVibGljIGJ1dHRvblJlc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgdGhpcy5yb3VuZFNjb3JlRWxlbWVudC5pbm5lckhUTUwgPSAnMCc7XG4gICAgICAgIHRoaXMuY3VycmVudEtleSA9ICcnO1xuICAgICAgICB0aGlzLnNjb3JlID0gMTAwO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gYCR7dGhpcy5zY29yZX1gO1xuICAgIH1cbn1cblxuY29uc3QgY3VycmVudEtleUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jdXJyZW50LWtleV0nKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XG5jb25zdCB0b3RhbFNjb3JlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRvdGFsLXNjb3JlXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3Qgcm91bmRTY29yZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1yb3VuZC1zY29yZV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IGJhbGxvb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtYmFsbG9vbi1pdGVtXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3QgcHJvZ3Jlc3NFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcHJvZ3Jlc3NdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBidXR0b25zQ29udGFpbmVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJ1dHRvbnMtY29udGFpbmVyXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3QgcmVjb3Jkc1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtdGVtcGxhY2UtcmVjb3Jkc10nKSBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xuY29uc3QgcmVjb3Jkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1yZWNvcmRzLWxpc3RdJykgYXMgSFRNTERMaXN0RWxlbWVudDtcblxuXG5jb25zdCBnYW1lID0gbmV3IEdhbWUoY3VycmVudEtleUVsZW1lbnQsIHRvdGFsU2NvcmVFbGVtZW50LCByb3VuZFNjb3JlRWxlbWVudCwgYmFsbG9vbkVsZW1lbnQsIHByb2dyZXNzRWxlbWVudCwgcmVjb3Jkc1RlbXBsYXRlLCByZWNvcmRzTGlzdCk7XG5nYW1lLnN0YXJ0KCk7XG5cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4ge1xuICAgIGdhbWUuY2hlY2tTY29yZSgpO1xuICAgIGNvbnN0IHByZXNzZWRLZXk6IHN0cmluZyA9IGUua2V5LnRvVXBwZXJDYXNlKCk7XG4gICAgaWYoIWdhbWUucGF1c2VkKSB7XG4gICAgICAgIGdhbWUuY2hlY2tQcmVzc2VkS2V5KHByZXNzZWRLZXkpO1xuICAgICAgICBnYW1lLnNldFJhbmRvbUtleSgpO1xuICAgICAgICBnYW1lLnNldFRpbWVyKCk7XG4gICAgfVxufSk7XG5cbmJ1dHRvbnNDb250YWluZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4ge1xuICAgIGlmKGV2ZW50LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIGV2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbiAhPT0gJycpIHtcbiAgICAgICAgaWYoZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uID09PSAnc3RhcnQnKSBnYW1lLmJ1dHRvblN0YXJ0KCk7XG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbiA9PT0gJ2VuZCcpIGdhbWUuYnV0dG9uRW5kKCk7XG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbiA9PT0gJ3Jlc3RhcnQnKSBnYW1lLmJ1dHRvblJlc3RhcnQoKTtcbiAgICB9XG59KSE7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=