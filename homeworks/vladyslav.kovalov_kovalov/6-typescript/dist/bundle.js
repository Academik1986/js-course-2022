class Game {
    constructor(
        currentKeyElement,
        totalScoreElement,
        roundScoreElement,
        balloonElement,
        progressElement) {
        this.currentKeyElement = currentKeyElement;
        this.totalScoreElement = totalScoreElement;
        this.roundScoreElement = roundScoreElement;
        this.balloonElement = balloonElement;
        this.progressElement = progressElement;
        this.LETTERS = "abcdefghijklmnopqrstuvwxyz";
        this.INTERVAL = 2000;
        this.FINAL_SCORE = 200;
        this.currentKey = '';
        this.score = 100;
        this.timer = '';
    }
    getRandomLetterPosition(letterString) {
        const maxLength = letterString.length;
        return Math.floor(Math.random() * maxLength);
    }
    getRandomLetter(letterString) {
        const position = this.getRandomLetterPosition(letterString);
        return letterString[position];
    }
    getRandomScore(min, max) {
        return Math.floor(Math.random() * (max - min) + min);
    }
    setRandomKey() {
        const randomLetter = this.getRandomLetter(this.LETTERS);
        this.currentKey = randomLetter.toUpperCase();
        this.currentKeyElement.textContent = this.currentKey;
    }
    setRoundScore(score, action) {
        this.roundScoreElement.textContent = `${action}${score}`;
    }
    updateTotalScore() {
        this.totalScoreElement.textContent = `${this.score.toString()}`;
    }
    increaseBalloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height + 5}px`;
        this.balloonElement.style.width = `${width + 5}px`;
    }
    decreaseBaloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height - 5}px`;
        this.balloonElement.style.width = `${width - 5}px`;
    }
    addScore() {
        if (this.score >= this.FINAL_SCORE) {
            console.log('You win!');
            clearInterval(this.timer);
            this.timer = '';
            this.progressElement.style.width = '0';
        }
        if (this.score < this.FINAL_SCORE) {
            const min = 5;
            const max = 10;
            const currentScore = this.getRandomScore(min, max);
            this.score += currentScore;
            this.setRoundScore(currentScore, '+');
            this.updateTotalScore();
            this.increaseBalloon();
        }
    }
    removeScore() {
        if (this.score <= 0) {
            console.log('You lose!');
            clearInterval(this.timer);
            this.timer = '';
            this.progressElement.style.width = '0';
        }
        if (this.score > 0) {
            const min = 20;
            const max = 25;
            const currentScore = this.getRandomScore(min, max);
            this.score -= currentScore;
            this.setRoundScore(currentScore, '-');
            this.updateTotalScore();
            this.decreaseBaloon();
        }
    }
    checkPressedKey(key) {
        if (key === this.currentKey) {
            clearInterval(this.timer);
            return this.addScore();
        }
        ;
        if (key !== this.currentKey) {
            clearInterval(this.timer);
            return this.removeScore();
        }
        ;
    }
    start() {
        this.setRandomKey();
    }
    setTimer() {
        let step = 10;
        let counter = 100;
        this.timer = setInterval(() => {
            console.log(this.timer);
            if (counter >= 0) {
                this.progressElement.style.width = counter + '%';
                counter -= step;
                return;
            }
            clearInterval(this.timer);
            const min = 20;
            const max = 25;
            const currentScore = this.getRandomScore(min, max);
            this.score -= currentScore;
            this.setRoundScore(currentScore, '-');
            this.updateTotalScore();
            this.decreaseBaloon();
        }, this.INTERVAL / 10);
    }
}
const currentKeyElement = document.querySelector('[data-current-key]');
const totalScoreElement = document.querySelector('[data-total-score]');
const roundScoreElement = document.querySelector('[data-round-score]');
const balloonElement = document.querySelector('[data-balloon-item]');
const progressElement = document.querySelector('[data-progress]');
const game = new Game(currentKeyElement, totalScoreElement, roundScoreElement, balloonElement, progressElement);
game.start();
document.addEventListener('keydown', e => {
    const pressedKey = e.key.toUpperCase();
    game.checkPressedKey(pressedKey);
    game.setRandomKey();
    game.setTimer();
});

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQy9DLElBQUksQ0FBQyxlQUFlLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDaEMsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3BCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUNyQixDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly82LXR5cGVzY3JpcHQvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgR2FtZSB7XG4gICAgcHJpdmF0ZSBMRVRURVJTOiBzdHJpbmcgPSBcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6XCI7XG4gICAgcHJpdmF0ZSBJTlRFUlZBTDogbnVtYmVyID0gMjAwMDtcbiAgICBwcml2YXRlIEZJTkFMX1NDT1JFOiBudW1iZXIgPSAyMDA7XG4gICAgcHJpdmF0ZSBjdXJyZW50S2V5OiBzdHJpbmcgPSAnJztcbiAgICBwcml2YXRlIHNjb3JlOiBudW1iZXIgPSAxMDA7XG5cdHByaXZhdGUgdGltZXI6IGFueSA9ICcnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY3VycmVudEtleUVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSB0b3RhbFNjb3JlRWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcm91bmRTY29yZUVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwcml2YXRlIGJhbGxvb25FbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwcm9ncmVzc0VsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICApIHt9XG5cbiAgICBwcml2YXRlIGdldFJhbmRvbUxldHRlclBvc2l0aW9uKGxldHRlclN0cmluZzogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgbWF4TGVuZ3RoID0gbGV0dGVyU3RyaW5nLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heExlbmd0aCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRSYW5kb21MZXR0ZXIobGV0dGVyU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuZ2V0UmFuZG9tTGV0dGVyUG9zaXRpb24obGV0dGVyU3RyaW5nKTtcbiAgICAgICAgcmV0dXJuIGxldHRlclN0cmluZ1twb3NpdGlvbl07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRSYW5kb21TY29yZShtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyAgbWluKTtcbiAgICB9XG5cbiAgICBzZXRSYW5kb21LZXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmRvbUxldHRlcjogc3RyaW5nID0gdGhpcy5nZXRSYW5kb21MZXR0ZXIodGhpcy5MRVRURVJTKTtcbiAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0gcmFuZG9tTGV0dGVyLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIHRoaXMuY3VycmVudEtleUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLmN1cnJlbnRLZXk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRSb3VuZFNjb3JlKHNjb3JlOiBudW1iZXIsIGFjdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHthY3Rpb259JHtzY29yZX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlVG90YWxTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuc2NvcmUudG9TdHJpbmcoKX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5jcmVhc2VCYWxsb29uKCk6IHZvaWQge1xuICAgICAgIGxldCB3aWR0aDogbnVtYmVyID0gdGhpcy5iYWxsb29uRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSB0aGlzLmJhbGxvb25FbGVtZW50Lm9mZnNldFdpZHRoO1xuXG4gICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHQgKyA1fXB4YDtcbiAgICAgICB0aGlzLmJhbGxvb25FbGVtZW50LnN0eWxlLndpZHRoID0gYCR7d2lkdGggKyA1fXB4YDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRlY3JlYXNlQmFsb29uKCkge1xuICAgICAgICBsZXQgd2lkdGg6IG51bWJlciA9IHRoaXMuYmFsbG9vbkVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgbGV0IGhlaWdodDogbnVtYmVyID0gdGhpcy5iYWxsb29uRWxlbWVudC5vZmZzZXRXaWR0aDtcblxuICAgICAgIHRoaXMuYmFsbG9vbkVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0IC0gNX1weGA7XG4gICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3dpZHRoIC0gNX1weGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgaWYodGhpcy5zY29yZSA+PSB0aGlzLkZJTkFMX1NDT1JFKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnWW91IHdpbiEnKTtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gJyc7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS53aWR0aCA9ICcwJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKHRoaXMuc2NvcmUgPCB0aGlzLkZJTkFMX1NDT1JFKSB7XG4gICAgICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDU7XG4gICAgICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDEwO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNjb3JlOiBudW1iZXIgPSB0aGlzLmdldFJhbmRvbVNjb3JlKG1pbiwgbWF4KTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gY3VycmVudFNjb3JlO1xuICAgICAgICAgICAgdGhpcy5zZXRSb3VuZFNjb3JlKGN1cnJlbnRTY29yZSwgJysnKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVG90YWxTY29yZSgpO1xuICAgICAgICAgICAgdGhpcy5pbmNyZWFzZUJhbGxvb24oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlU2NvcmUoKTogdm9pZCB7XG4gICAgICAgIGlmKHRoaXMuc2NvcmUgPD0gMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1lvdSBsb3NlIScpO1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSAnJztcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NFbGVtZW50LnN0eWxlLndpZHRoID0gJzAnO1xuICAgICAgICB9XG5cbiAgICAgICBpZih0aGlzLnNjb3JlID4gMCkge1xuICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDIwO1xuICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDI1O1xuICAgICAgICBjb25zdCBjdXJyZW50U2NvcmU6IG51bWJlciA9IHRoaXMuZ2V0UmFuZG9tU2NvcmUobWluLCBtYXgpO1xuICAgICAgICB0aGlzLnNjb3JlIC09IGN1cnJlbnRTY29yZTtcbiAgICAgICAgdGhpcy5zZXRSb3VuZFNjb3JlKGN1cnJlbnRTY29yZSwgJy0nKTtcbiAgICAgICAgdGhpcy51cGRhdGVUb3RhbFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZGVjcmVhc2VCYWxvb24oKVxuICAgICAgIH1cbiAgICB9XG5cbiAgICBjaGVja1ByZXNzZWRLZXkoa2V5OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgaWYoa2V5ID09PSB0aGlzLmN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRTY29yZSgpXG4gICAgICAgIH07XG4gICAgICAgIGlmKGtleSAhPT0gdGhpcy5jdXJyZW50S2V5KSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlU2NvcmUoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLnNldFJhbmRvbUtleSgpO1xuXG4gICAgfVxuXG5cdHNldFRpbWVyKCk6dm9pZCB7XG5cdFx0XHRsZXQgc3RlcCA9IDEwO1xuXHRcdFx0bGV0IGNvdW50ZXIgPSAxMDA7XG5cdFx0XHR0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMudGltZXIpO1xuXHRcdFx0XHRpZihjb3VudGVyID49IDApIHtcblx0XHRcdFx0XHR0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS53aWR0aCA9IGNvdW50ZXIgKyAnJSc7XG5cdFx0XHRcdFx0Y291bnRlciAtPSBzdGVwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cdFx0XHRcdH1cblxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDIwO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1heDogbnVtYmVyID0gMjU7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFNjb3JlOiBudW1iZXIgPSB0aGlzLmdldFJhbmRvbVNjb3JlKG1pbiwgbWF4KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjb3JlIC09IGN1cnJlbnRTY29yZTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFJvdW5kU2NvcmUoY3VycmVudFNjb3JlLCAnLScpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVG90YWxTY29yZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGVjcmVhc2VCYWxvb24oKVxuXHRcdFx0fSwgdGhpcy5JTlRFUlZBTCAvIDEwKTtcblx0XHR9XG59XG5cbmNvbnN0IGN1cnJlbnRLZXlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3VycmVudC1rZXldJykgYXMgSFRNTFNwYW5FbGVtZW50O1xuY29uc3QgdG90YWxTY29yZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10b3RhbC1zY29yZV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IHJvdW5kU2NvcmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcm91bmQtc2NvcmVdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBiYWxsb29uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJhbGxvb24taXRlbV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IHByb2dyZXNzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXByb2dyZXNzXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuXG5jb25zdCBnYW1lID0gbmV3IEdhbWUoY3VycmVudEtleUVsZW1lbnQsIHRvdGFsU2NvcmVFbGVtZW50LCByb3VuZFNjb3JlRWxlbWVudCwgYmFsbG9vbkVsZW1lbnQsIHByb2dyZXNzRWxlbWVudCk7XG5nYW1lLnN0YXJ0KCk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHtcbiAgICBjb25zdCBwcmVzc2VkS2V5OiBzdHJpbmcgPSBlLmtleS50b1VwcGVyQ2FzZSgpO1xuICAgIGdhbWUuY2hlY2tQcmVzc2VkS2V5KHByZXNzZWRLZXkpO1xuICAgICBnYW1lLnNldFJhbmRvbUtleSgpO1xuICAgICBnYW1lLnNldFRpbWVyKCk7XG59KVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9
